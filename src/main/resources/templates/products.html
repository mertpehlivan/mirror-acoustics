<!DOCTYPE html>
<html lang="tr" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: layout(${title}, ~{::content})}">
<th:block th:fragment="content">
    <div class="py-8">
        <div class="flex items-end justify-between mb-6 gap-4 flex-wrap">
            <div>
                <h1 class="text-2xl md:text-3xl font-semibold text-brand-900" th:text="#{nav.products}">Ürünler</h1>
                <div class="text-sm text-neutral-500 mt-1" th:if="${categorySlug != null}">
                    <span th:text="#{products.category}">Kategori:</span>
                    <strong th:text="${categorySlug}">genel</strong>
                </div>
            </div>
            <form class="w-full md:w-auto flex gap-2" th:action="@{/urun}" method="get">
                <input class="border rounded-lg px-3 py-2 w-full md:w-72 focus:outline-none focus:ring-2 focus:ring-brand-400" type="text" name="q" th:value="${q}" th:placeholder="#{products.searchPlaceholder}">
                <button class="px-4 py-2 rounded-lg border hover:bg-neutral-50" type="submit" th:text="#{common.search}">Ara</button>
            </form>
        </div>

        <div th:if="${page == null or page.empty}" class="text-muted">
            <p th:text="#{products.noProducts}">Henüz ürün yok.</p>
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" th:if="${page != null and !page.empty}">
            <a class="group rounded-2xl overflow-hidden border border-neutral-200 bg-white hover:shadow-lg hover:shadow-lg hover:-translate-y-0.5 transition p-3" th:each="p : ${page}"
                th:href="@{|/urun/${p.slug}|}">
                <div class="aspect-[4/3] w-full overflow-hidden rounded-xl bg-neutral-100">
                    <img th:if="${#lists.size(p.images)>0}" th:src="${p.images.get(0).url}" class="w-full h-full object-cover group-hover:scale-105 transition" th:alt="${lang=='en'? p.titleEn : p.titleTr}" loading="lazy" />
                </div>
                <div class="pt-3">
                    <h2 class="text-base font-semibold text-neutral-900 group-hover:text-brand-900 line-clamp" th:text="${lang=='en'? p.titleEn : p.titleTr}">Ürün Adı</h2>
                    <div class="mt-1 text-sm text-neutral-600" th:text="${p.currency} + ' ' + ${#numbers.formatDecimal(p.price, 1, 'POINT', 2, 'POINT')}">₺ 0,00</div>
                </div>
            </a>
        </div>

        <nav th:if="${page != null and page.totalPages > 1}" aria-label="Sayfalama" class="mt-8">
            <div class="flex items-center gap-2 justify-center">
                <a class="px-3 py-1 rounded-lg border hover:bg-neutral-50"
                    th:classappend="${page.first}? 'pointer-events-none opacity-50'"
                    th:href="@{|/urun?page=${page.number-1}&q=${q}|}" th:text="#{common.previous}">Önceki</a>
                <span class="text-sm text-neutral-500" th:text="${page.number+1} + ' / ' + ${page.totalPages}">1 / 1</span>
                <a class="px-3 py-1 rounded-lg border hover:bg-neutral-50"
                    th:classappend="${page.last}? 'pointer-events-none opacity-50'"
                    th:href="@{|/urun?page=${page.number+1}&q=${q}|}" th:text="#{common.next}">Sonraki</a>
            </div>
        </nav>
    </div>
</th:block>

</html>